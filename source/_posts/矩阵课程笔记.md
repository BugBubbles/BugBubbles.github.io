---
title: 矩阵课程笔记
date: 2023-07-15 16:26:27
cover: 更换后的输出文件.png
katex: ture
tags: 学习
---
个人写作笔记，如有问题，请不吝赐教！
目录如下：
- [矩阵之间的关系](#矩阵之间的关系)
- [若当标准形](#若当标准形)
  - [矩阵多项式](#矩阵多项式)
  - [若当标准化](#若当标准化)
  - [凯莱-哈密顿定理](#凯莱-哈密顿定理)
- [矩阵的范数](#矩阵的范数)
  - [矩阵原生范数](#矩阵原生范数)
  - [向量范数导出的矩阵范数](#向量范数导出的矩阵范数)
- [矩阵分析应用](#矩阵分析应用)
  - [矩阵函数](#矩阵函数)
  - [矩阵的微积分](#矩阵的微积分)
    - [定义](#定义)
      - [矩阵函数对纯量求导](#矩阵函数对纯量求导)
      - [纯量对向量的导数](#纯量对向量的导数)
    - [复杂导数](#复杂导数)
      - [预备知识：矩阵直积](#预备知识：矩阵直积)
      - [矩阵对矩阵的导数](#矩阵对矩阵的导数)
    - [求导运算法则](#求导运算法则)
      - [矩阵对列向量求导](#矩阵对列向量求导)
      - [向量对向量求导](#向量对向量求导)
      - [矩阵迹的导数](#矩阵迹的导数)
      - [矩阵范数的导数](#矩阵范数的导数)
    - [矩阵的全微分](#矩阵的全微分)
    - [运算式证明](#运算式证明)

# 矩阵之间的关系
相抵：$\bm{A},\bm{B}\in \mathbb{C}^{m\times n},\bm{A}\backsimeq\bm{B} \iff \exist \bm{U}\in \mathbb{C}^{m\times m}, \bm{V}\in \mathbb{C}^{n\times n},s.t.\quad \bm{ B=UAV}$
相似、合同变换都是一种相抵关系。
正规矩阵：$\bm{A}\in \mathbb{C}^{n\times n},\bm{AA}^{\rm H}=\bm{A}^{\rm H}\bm{A}$，实正规矩阵即为实数域
单纯矩阵：每个特征值的代数重复度（特征值的重数）和几何重复度（特征值对应的解向量的个数）相等的矩阵，可以相似对角化，又称为简单矩阵。
# 若当标准形
## 矩阵多项式
不变因子：史密斯标准形对角线非零元素（对$\lambda$矩阵进行初等变换得到的标准形，可看作是特征值）
$k$阶行列式因子：$\lambda$矩阵中全部$k$阶子式的最大公因式，例如，一阶行列式因子就是矩阵中全部元素的最大公因子，二阶行列式因子就是全面二阶子式中的最大公因子，以此类推）
初等因子：组成不变因子的全部含$\lambda$项，即形如$(\lambda-\lambda_j)^{e_{ij}},e_{ij}\ne 0$的式子

## 若当标准化
若当标准形：
$$
\begin{bmatrix}
\lambda_1&1&0&\cdots&0\\
0&\lambda_2&1&\cdots&0\\
\vdots&\vdots&\ddots&\ddots&\vdots\\
0&0&\cdots&\lambda_{n-1}&1\\
0&0&0&\cdots&\lambda_n\\
\end{bmatrix}
$$
求取若当标准形：
1.求出全部的初等因子，保证因子次数之和等于矩阵的秩
2.根据每个初等因子，写出对应的若当块，例如初等因子$(\lambda-\lambda_i)^{m_i}$对应的若当块是：
$$
\bm{J_i}=\begin{bmatrix}
\lambda_i&1&& \\
&\lambda_i&\ddots&\\
&&\ddots&1\\
&&&\lambda_i\\
\end{bmatrix}
$$
3.根据这些若当块，组成若当标准形：
$$
\bm{J}=\begin{bmatrix}
\bm{J_1}&&&\\
&\bm{J_2}&&\\
&&\ddots&\\
&&&\bm{J_r}\\
\end{bmatrix}
$$
## 凯莱-哈密顿定理
方阵满足其特征多项式，即$f(\bm{A})=0$
可用于计算方阵的n次幂

# 矩阵的范数
$\displaystyle\forall\bm A\in\mathbb{C}^{m\times n}$，定义以下的范数：
## 矩阵原生范数
总和范数：$\displaystyle||\bm{A}||_M=\sum^n_{j=1}\sum^m_{i=1} |a_{ij}|$
F范数：$\displaystyle||\bm{A}||_F=\sum^n_{j=1}\sum^m_{i=1} |a_{ij}|^2$
G范数：$\displaystyle||\bm{A}||_G=n\cdot \max_{i,j}\sum^n_{i=1} |a_{ij}|$
## 向量范数导出的矩阵范数
矩阵的最大奇异值称为矩阵的谱半径，用 $\displaystyle\rho({\bm{A}})=\max\{s_i\}_{i=1}^{n}$ 表示。
行和范数：$\displaystyle||\bm{A}||_{\infty}=\sum^n_{j=1} |a_{ij}|$
列和范数：$\displaystyle||\bm{A}||_1=\sum^m_{i=1} |a_{ij}|$
谱范数：$\displaystyle||\bm{A}||_2=\max\{s_i\}_{i=1}^{n}$
# 矩阵分析应用
## 矩阵函数
 1.对于单纯矩阵
找到一个变换矩阵$\bm Q$，使得矩阵对角化为$\bm B$，即：
$$\bm{B}=Diag[f(\lambda_1),f(\lambda_2),\cdots,f(\lambda_n)]=\bm{Q}^{-1}\bm{AQ}
$$矩阵函数定义为：
$$
\begin{align*}
&\bm{Q}^{-1}f(\bm{A})\bm{Q}=Diag[f(\lambda_1),f(\lambda_2),\cdots,f(\lambda_n)]\\
&\implies f(\bm{A})=\bm{Q}^{-1}Diag[f(\lambda_1),f(\lambda_2),\cdots,f(\lambda_n)]\bm{Q}
\end{align*}
$$

 2.对于亏损矩阵（不能保证代数和几何重复度相等，但是可以保证所有特征向量线性无关的矩阵）
找到一个变换矩阵$\bm T$，使得矩阵若当标准化为$\bm J$，即：
$$\bm{J}=Diag[f(\bm{J_1}(\lambda_1)),f(\bm{J_2}(\lambda_2)),\cdots,f(\bm{J_r}(\lambda_r))]=\bm{T}^{-1}\bm{AT}$$矩阵函数定义为：
$$
\begin{align*}
&\bm{T}^{-1}f(\bm{A})\bm{T}=Diag[f(\bm{J_1}(\lambda_1)),f(\bm{J_2}(\lambda_2)),\cdots,f(\bm{J_r}(\lambda_r))]\\
&\implies f(\bm{A})=\bm{T}^{-1}Diag[f(\bm{J_1}(\lambda_1)),f(\bm{J_2}(\lambda_2)),\cdots,f(\bm{J_r}(\lambda_r))]\bm{T}
\end{align*}
$$
## 矩阵的微积分
### 定义
#### 矩阵函数对纯量求导
设矩阵$\bm A\in\mathbb{C}^{m\times n}$，矩阵函数$\bm F(\bm A):\mathbb{C}^{m\times n}\longmapsto \mathbb{C}^{p\times q}$，其全微分满足以下式子：
$$
\frac{{\rm d}\bm F(\bm A)}{{\rm d}a_{ij}}=\left[
\begin{matrix}
\frac{{\rm d}f_{11}}{{\rm d}a_{ij}}&\frac{{\rm d}f_{12}}{{\rm d}a_{ij}}&\cdots&\frac{{\rm d}f_{1q}}{{\rm d}a_{ij}}\\\\
\frac{{\rm d}f_{21}}{{\rm d}a_{ij}}&\frac{{\rm d}f_{22}}{{\rm d}a_{ij}}&\cdots&\frac{{\rm d}f_{2q}}{{\rm d}a_{ij}}\\\\
\vdots&\vdots&&\vdots\\\\
\frac{{\rm d}f_{p1}}{{\rm d}a_{ij}}&\frac{{\rm d}f_{p2}}{{\rm d}a_{ij}}&\cdots&\frac{{\rm d}f_{pq}}{{\rm d}a_{ij}}
\end{matrix}
\right]
$$
#### 纯量对向量的导数
设列向量 $\bm X\in\mathbb{C}^{n\times1}$，对于一个向量值函数$f(\bm X):\mathbb{C}^{n\times1}\longmapsto \mathbb{C}$，其全微分满足以下式子：
$$
{\rm d}f(\bm X)=\sum_{i=1}^n\frac{\partial f}{\partial x_i}{\rm d}x_i
$$将式子改写成矩阵的形式，则有：
$$
{\rm d}f(\bm X)=\left[\begin{matrix}
\frac{\partial f}{\partial x_1}&\frac{\partial f}{\partial x_2}&\cdots&\frac{\partial f}{\partial x_q}
\end{matrix}\right]
\left[\begin{matrix}
{\rm d}x_1\\\\
{\rm d}x_2\\\\
\vdots\\\\
{\rm d}x_q
\end{matrix}\right]
$$矩阵导数有多种表示形式，常见的如分子求导式或者分母求导式，本文选取的是分母求导式，其人为定义如下：
$$
\frac{{\rm d}f(\bm X)}{\rm d \bm X}=\left[\begin{matrix}
\frac{\partial f}{\partial x_1}&\frac{\partial f}{\partial x_2}&\cdots&\frac{\partial f}{\partial x_q}
\end{matrix}\right]\quad\rm d\bm X=\left[\begin{matrix}
{\rm d}x_1\\\\
{\rm d}x_2\\\\
\vdots\\\\
{\rm d}x_q
\end{matrix}\right]
$$设$\bm A\in\mathbb{C}^{m\times n}$，$\bm X, \bm Y\in\mathbb{C}^{n\times1}$，则必有：
$$
\left\{\begin{align*}
\frac{{\rm d}\bm Y}{{\rm d}\bm X^{\rm H}}&=\Big(\frac{{\rm d}\bm Y^{\rm H}}{{\rm d}\bm X}\Big)^{\rm H}\\
\frac{{\rm d}\bm A\bm X}{{\rm d}\bm X}&=\bm A
\end{align*}\right.
$$纯量对矩阵的求导满足简单的运算法则：
$$
\frac{{\rm d}[f(\bm X)\pm g(\bm X)]}{{\rm d}\bm X}=\frac{{\rm d}f(\bm X)}{{\rm d}\bm X}\pm\frac{{\rm d}g(\bm X)}{{\rm d}\bm X}
$$
$$
\frac{{\rm d}f(\bm X)g(\bm X)}{{\rm d}\bm X}=\frac{{\rm d}f(\bm X)}{{\rm d}\bm X}g(\bm X)+f(\bm X)\frac{{\rm d}g(\bm X)}{{\rm d}\bm X}
$$
### 复杂导数
下面包含矩阵之间、向量之间的导数，直接计算十分繁杂，通过以下几步公式可以简化运算。
#### 预备知识：矩阵直积
引入克罗内克记号（矩阵直积）：$\otimes$
若设 $\bm{A}\in R^{m\times p},\bm{B}\in R^{n\times p},\bm X\in R^{q\times 1}$，记：
$$
\bm{A}\otimes \bm{B}\triangleq\begin{bmatrix}
a_{11}\bm{B}&a_{12}\bm{B}&\cdots&a_{1p}\bm{B}\\
a_{21}\bm{B}&a_{22}\bm{B}&\cdots&a_{2p}\bm{B}\\
\vdots&\vdots&&\vdots\\
a_{m1}\bm{B}&a_{m2}\bm{B}&\cdots&a_{mp}\bm{B}\\
\end{bmatrix}_{mn\times pq}
$$
#### 矩阵对矩阵的导数
$\exist \bm{F}\in C^{p\times q},\bm{A}\in C^{m\times n}$，有：
$$
\frac{{\rm d}\bm{F}}{{\rm d}\bm{A}}=\begin{bmatrix}
\frac{\partial \bm{F}}{\partial a_{11}}&\frac{\partial \bm{F}}{\partial a_{21}}&\cdots&\frac{\partial \bm{F}}{\partial a_{m1}}\\\\
\frac{\partial \bm{F}}{\partial a_{12}}&\frac{\partial \bm{F}}{\partial a_{22}}&\cdots&\frac{\partial \bm{F}}{\partial a_{m2}}\\\\
\vdots&\vdots&&\vdots\\\\
\frac{\partial \bm{F}}{\partial a_{1n}}&\frac{\partial \bm{F}}{\partial a_{2n}}&\cdots&\frac{\partial \bm{F}}{\partial a_{mn}}
\end{bmatrix}\triangleq\frac{\rm d}{\rm d\bm A}\otimes\bm F
$$尤其注意，矩阵梯度形状与微分变量有转置关系：
$$
\frac{{\rm d}}{{\rm d}\bm{A}}\triangleq
\begin{bmatrix}
\frac{\partial }{\partial a_{11}}&\frac{\partial }{\partial a_{21}}&\cdots&\frac{\partial }{\partial a_{m1}}\\\\
\frac{\partial }{\partial a_{12}}&\frac{\partial }{\partial a_{22}}&\cdots&\frac{\partial }{\partial a_{m2}}\\\\
\vdots&\vdots&&\vdots\\\\
\frac{\partial }{\partial a_{1n}}&\frac{\partial }{\partial a_{2n}}&\cdots&\frac{\partial }{\partial a_{mn}}
\end{bmatrix}
$$可见导数的形状为$\frac{{\rm d}\bm{F}}{{\rm d}\bm{A}}\in\mathbb{C}^{np\times mq}$，相当于原函数形状对微分变量转置形状的直积。简记为：
$$
\begin{align*}
\frac{{\rm d}\bm{F}}{{\rm d}\bm{A}}\triangleq\frac{{\rm d}}{{\rm d}\bm A}\otimes\bm F\triangleq\nabla_{\bm A}\otimes\bm F
\end{align*}
$$当原函数退化为纯量时，矩阵直积退化为向量梯度场：
$$
\begin{align*}
\frac{{\rm d}f}{{\rm d}\bm{A}}\triangleq\frac{{\rm d}}{{\rm d}\bm A}f\triangleq\nabla_{\bm A}f
\end{align*}
$$这是一个重要结论，可以用于验证导数求解的正确性。
### 求导运算法则
#### 矩阵对列向量求导
特别地，当微分变量是列向量时，设 $\bm{A}\in\mathbb{C}^{m\times n}$，$\bm{B}\in\mathbb{C}^{n\times p}$，$\bm{X}\in\mathbb{C}^{n\times1}$， $f(\bm{X})$ 是一个纯量函数，可以得出以下的求导结论，有：
$$
\begin{align*}
\left\{
  \begin{aligned}
&\frac{{\rm d}\big(\bm{A}\pm\bm{B}\big)}{{\rm d}\bm{X}}=\frac{{\rm d}\bm{A}}{{\rm d}\bm{X}}\pm\frac{{\rm d}\bm{B}}{{\rm d}\bm{X}}\\\\
&\frac{{\rm d}f_{\bm X}\bm{B}}{{\rm d}\bm{X}}=\frac{{\rm d}f_{\bm X}}{{\rm d}\bm{X}}\otimes\bm{B}+f_{\bm X}\frac{{\rm d}\bm{B}}{{\rm d}\bm{X}}\\\\
&\frac{{\rm d}\bm{A}\bm{B}}{{\rm d}\bm{X}}=\frac{{\rm d}\bm{A}}{{\rm d}\bm{X}}\big(\bm I_q\otimes\bm{B}\big)+\bm{A}\frac{{\rm d}\bm{B}}{{\rm d}\bm{X}}
\end{aligned}
\right.
\end{align*}
$$
#### 向量对向量求导
特别地，当函数也退化为向量时，直积部分可以省略。设 $\bm{X}\in\mathbb{C}^{m\times 1}$， $\bm{Y,Z}\in\mathbb{C}^{n\times 1}$， $f(\bm{X})$ 是一个纯量函数，有以下更为简洁的公式：
$$
\begin{align*}
\left\{
\begin{aligned}
&\frac{{\rm d}(\bm{Y}\pm\bm{Z})}{{\rm d}\bm{X}}=\frac{{\rm d}\bm{Y}}{{\rm d}\bm{X}}\pm\frac{{\rm d}\bm{Z}}{{\rm d}\bm{X}}\\\\
&\frac{{\rm d}(f_{\bm X}\bm{Z})}{{\rm d}\bm{X}}=\frac{{\rm d}f_{\bm X}}{{\rm d}\bm{X}}\otimes\bm{Z}+f_{\bm X}\frac{{\rm d}\bm{Z}}{{\rm d}\bm{X}}=\bm{Z}\frac{{\rm d}f_{\bm X}}{{\rm d}\bm{X}^{\rm H}}+f_{\bm X}\frac{{\rm d}\bm{Z}}{{\rm d}\bm{X}}\\\\
&\frac{{\rm d}(\bm{Y}^{\rm H}\bm{Z})}{{\rm d}\bm{X}}=\bm{Z}^{\rm H}\frac{{\rm d}\bm{Y}}{{\rm d}\bm{X}}+\bm{Y}^{\rm H}\frac{{\rm d}\bm{Z}}{{\rm d}\bm{X}}
\end{aligned}
\right.
\end{align*}
$$
#### 矩阵迹的导数
未完待续...
#### 矩阵范数的导数
未完待续...
### 矩阵的全微分
性质：线性性，转置和追迹（主对角线上元素之和）运算与微分可换顺序：${\rm d}(\bm{X}^{\rm H})=({\rm d}\bm{X})^{\rm H}$,${\rm d}(tr\bm{X})=tr({\rm d}\bm{X})$
注意，矩阵求导不能认为是微商。
一个重要公式：
若设$\bm{X}$是n维列向量，$\bm{Y}$是m维列向量，$\bm{A}$是$n\times m$维矩阵，则有：
$\bm{X}^{\rm H}\bm{AY}=\sum^n_{i=1}\sum^m_{j=1}a_{ij}x_iy_j$


### 运算式证明
矩阵求导乘积法则推导过程：
设矩阵${\bm A}\in\mathbb{C}^{m\times n},\bm B\in\mathbb{C}^{n\times p}$，列向量$\bm X\in\mathbb{C}^{n\times1}$，证明以下公式成立：
$$
\frac{{\rm d}\bm{A}\bm{B}}{{\rm d}\bm{X}}=\frac{{\rm d}\bm{A}}{{\rm d}\bm{X}}\big(\bm I_q\otimes\bm{B}\big)+\bm{A}\frac{{\rm d}\bm{B}}{{\rm d}\bm{X}}
$$取定矩阵$\bm A$的行向量和矩阵$\bm B$的列向量：
$$
A=\left[
\begin{matrix}
a_{11}&a_{12}&\cdots&a_{1n}\\
a_{21}&a_{22}&\cdots&a_{2n}\\
\vdots&\vdots&&\vdots\\
a_{m1}&a_{m2}&\cdots&a_{mn}\\
\end{matrix}
\right]=\left[
\begin{matrix}
\alpha_1^{\rm H}\\
\alpha_2^{\rm H}\\
\vdots\\
\alpha_m^{\rm H}\\
\end{matrix}
\right]
\quad
\begin{align*}
B&=\left[
\begin{matrix}
b_{11}&b_{12}&\cdots&b_{1p}\\
b_{21}&b_{22}&\cdots&b_{2p}\\
\vdots&\vdots&&\vdots\\
b_{n1}&b_{n2}&\cdots&b_{np}\\
\end{matrix}
\right]\\
&=\left[
\begin{matrix}
\beta_1\quad
\beta_2\quad
\cdots\quad
\beta_p
\end{matrix}
\right]
\end{align*}
$$则有：
$$
\begin{align*}
\bm{AB}&=\left[
\begin{matrix}
\alpha_1^{\rm H}\beta_1&\alpha_1^{\rm H}\beta_2&\cdots&\alpha_1^{\rm H}\beta_p\\\\
\alpha_2^{\rm H}\beta_1&\alpha_2^{\rm H}\beta_2&\cdots&\alpha_2^{\rm H}\beta_p\\\\
\vdots&\vdots&&\vdots\\\\
\alpha_m^{\rm H}\beta_1&\alpha_m^{\rm H}\beta_2&\cdots&\alpha_m^{\rm H}\beta_p
\end{matrix}
\right]\\\\
\implies\frac{\rm d\bm{AB}}{{\rm d} \bm X}&=
\begin{bmatrix}
\frac{{\rm d}\bm{AB}}{{\rm d}x_1}&\frac{{\rm d}\bm{AB}}{{\rm d}x_2}&\cdots&\frac{{\rm d}\bm{AB}}{{\rm d}x_q}
\end{bmatrix}
\end{align*}
$$由于各项形式完全一致，考虑第一项$\displaystyle\frac{{\rm d}\bm{AB}}{{\rm d}x_1}$即可，这是一项纯量对向量求导，直接化简可得：
$$
\begin{align}
\frac{{\rm d}\bm{AB}}{{\rm d}x_1}=\frac{{\rm d}\bm{A}}{{\rm d}x_1}\bm B+\bm A\frac{{\rm d}\bm{B}}{{\rm d}x_1}
\end{align}
$$可知最终结果必含两项，先考虑由 $\displaystyle\frac{{\rm d}\bm{A}}{{\rm d}x_i}\bm B$ 代表的一项，即有：
$$
\begin{align*}
&\begin{bmatrix}
\frac{{\rm d}\bm{A}}{{\rm d}x_1}\bm B&\frac{{\rm d}\bm{A}}{{\rm d}x_2}\bm B&\cdots&\frac{{\rm d}\bm{A}}{{\rm d}x_q}\bm B
\end{bmatrix}\\\\
&=\begin{bmatrix}
\frac{{\rm d}\bm{A}}{{\rm d}x_1}&\frac{{\rm d}\bm{A}}{{\rm d}x_2}&\cdots&\frac{{\rm d}\bm{A}}{{\rm d}x_q}
\end{bmatrix}\cdot\big(\bm I_q\otimes\bm B\big)\\\\
&=\frac{{\rm d}\bm{A}}{{\rm d}\bm X}\big(\bm I_q\otimes\bm B\big)
\end{align*}
$$即为待证结果第一项，再考虑由 $\displaystyle\bm A\frac{{\rm d}\bm{B}}{{\rm d}x_i}$ 代表的一项，有：
$$
\begin{align*}
&\begin{bmatrix}
\bm A\frac{{\rm d}\bm{B}}{{\rm d}x_1}&\bm A\frac{{\rm d}\bm{B}}{{\rm d}x_2}&\cdots&\bm A\frac{{\rm d}\bm{B}}{{\rm d}x_q}
\end{bmatrix}\\\\
&=\bm A\begin{bmatrix}
\frac{{\rm d}\bm{B}}{{\rm d}x_1}&\frac{{\rm d}\bm{B}}{{\rm d}x_2}&\cdots&\frac{{\rm d}\bm{B}}{{\rm d}x_q}
\end{bmatrix}\\\\
&=\bm A\frac{{\rm d}\bm{B}}{{\rm d}\bm X}
\end{align*}
$$这里，能够直接提取公因式的原因是，左乘的矩阵 $\displaystyle\bm A$ 是按行与矩阵 $\displaystyle\frac{{\rm d}\bm{B}}{{\rm d}x_q}$ 的列相乘，提取后的分块矩阵==列==的形状是维持不变的，因此可以提取公因式；而在上一个式子中，由于矩阵 $\displaystyle\bm B$ 是右乘的，因此提取出公因式后左边剩余的分块矩阵==行==的形状倍增$q$倍，因此不可直接提取公因式，需要引入矩阵直积。
综上，原公式得到了证明。
